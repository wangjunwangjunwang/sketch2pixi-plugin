{"version":3,"sources":["webpack://exports/webpack/bootstrap","webpack://exports/./node_modules/@skpm/fs/index.js","webpack://exports/./src/my-command.js","webpack://exports/./src/util.js","webpack://exports/external \"buffer\"","webpack://exports/external \"sketch\"","webpack://exports/external \"sketch/dom\"","webpack://exports/external \"util\""],"names":["fs","require","util","toArray","Dom","types","MSTextLayer","MSRectangleShape","MSBitmapLayer","MSLayerGroup","MSHotspotLayer","Document","json","screen","width","height","background","backgroundColor","bgScale","res","eases","moveIn","moveOut","zoomIn","zoomOut","fonts","main","x","y","scale","son","content","artboards","document","getSelectedDocument","globalContent","doc","pages","forEach","page","index","console","log","name","layers","createLevel","writeFileSync","getScriptFolder","JSON","stringify","parts","scriptPath","split","pop","join","artboard","current","objectID","layer","type","class","id","tempLayer","getLayerWithID","format","getImageFormat","indexOf","hidden","flow","targetId","artboardLayer","getArtboard","sonLayer","getSonByHotspot","frame","left","top","sonContent","data","getTypeByLayerType","look","sonTempLayer","createElement","push","style","rotation","alpha","opacity","overSon","isOverSon","angle","i","length","j","layerType","fill","fills","border","borders","textColor","Object","assign","text","stringValue","fontFamily","font","fontName","fontSize","rgb2hex","red","green","blue","lineHeight","leading","align","textAlignment","wordWrap","breakWords","wordWrapWith","radius","cornerRadiusFloat","getColor","color","getAlphaFromHex","lineWidth","thickness","lineColor","lineOpacity","lineAlign","position","src","getName","exportFormats","exportOptions","fileFormat","replace","exports","hex","parseInt","slice","isPercent","toString","includes","Math","round","TypeError","rgb"],"mappings":";;;;;;AAAA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;;AAGA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA,kDAA0C,gCAAgC;AAC1E;AACA;;AAEA;AACA;AACA;AACA,gEAAwD,kBAAkB;AAC1E;AACA,yDAAiD,cAAc;AAC/D;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iDAAyC,iCAAiC;AAC1E,wHAAgH,mBAAmB,EAAE;AACrI;AACA;;AAEA;AACA;AACA;AACA,mCAA2B,0BAA0B,EAAE;AACvD,yCAAiC,eAAe;AAChD;AACA;AACA;;AAEA;AACA,8DAAsD,+DAA+D;;AAErH;AACA;;;AAGA;AACA;;;;;;;;;;;;AClFA;AACA;AACA,aAAa,mBAAO,CAAC,sBAAQ;;AAE7B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,GAAG;;AAEH;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;;AAEH;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA,mBAAmB,OAAO;AAC1B;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,iBAAiB,kBAAkB;AACnC;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,GAAG;AACH;AACA,GAAG;AACH;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,+BAA+B,sDAAsD;AACrF,mCAAmC,0DAA0D;AAC7F,6BAA6B,mDAAmD;AAChF,wBAAwB,eAAe;AACvC,wBAAwB,iDAAiD;AACzE,0BAA0B,gDAAgD;AAC1E,gCAAgC,sDAAsD;AACtF;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,GAAG;;AAEH;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;;;;;;;;;;;;AC1RA;AAAA;AAAA;CACA;;AACA,IAAMA,EAAE,GAAGC,mBAAO,CAAC,kDAAD,CAAlB;;AACA,IAAMC,IAAI,GAAGD,mBAAO,CAAC,6BAAD,CAApB;;eACoBA,mBAAO,CAAC,kBAAD,C;IAAnBE,O,YAAAA,O;;AACR,IAAIC,GAAG,GAAGH,mBAAO,CAAC,8BAAD,CAAjB,C,CACA;;;AACA,IAAMI,KAAK,GAAG,CACZC,WADY,EACCC,gBADD,EACmBC,aADnB,EACkCC,YADlC,EACgDC,cADhD,CAAd;AAIA,IAAIC,QAAQ,GAAGP,GAAG,CAACO,QAAnB;AACA,IAAIC,IAAI,GAAG;AACTC,QAAM,EAAE;AACNC,SAAK,EAAE,IADD;AAENC,UAAM,EAAE;AAFF,GADC;AAKTC,YAAU,EAAE,EALH;AAMTC,iBAAe,EAAE,UANR;AAOTC,SAAO,EAAE,I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","file":"my-command.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = \"./src/my-command.js\");\n","// TODO: async. Should probably be done with NSFileHandle and some notifications\n// TODO: file descriptor. Needs to be done with NSFileHandle\nvar Buffer = require('buffer').Buffer\n\nfunction encodingFromOptions(options, defaultValue) {\n  return options && options.encoding\n    ? String(options.encoding)\n    : (\n      options\n        ? String(options)\n        : defaultValue\n    )\n}\n\nmodule.exports.constants = {\n  F_OK: 0,\n  R_OK: 4,\n  W_OK: 2,\n  X_OK: 1\n}\n\nmodule.exports.accessSync = function(path, mode) {\n  mode = mode | 0\n  var fileManager = NSFileManager.defaultManager()\n\n  switch (mode) {\n    case 0:\n      canAccess = module.exports.existsSync(path)\n      break\n    case 1:\n      canAccess = Boolean(Number(fileManager.isExecutableFileAtPath(path)))\n      break\n    case 2:\n      canAccess = Boolean(Number(fileManager.isWritableFileAtPath(path)))\n      break\n    case 3:\n      canAccess = Boolean(Number(fileManager.isExecutableFileAtPath(path))) && Boolean(Number(fileManager.isWritableFileAtPath(path)))\n      break\n    case 4:\n      canAccess = Boolean(Number(fileManager.isReadableFileAtPath(path)))\n      break\n    case 5:\n      canAccess = Boolean(Number(fileManager.isReadableFileAtPath(path))) && Boolean(Number(fileManager.isExecutableFileAtPath(path)))\n      break\n    case 6:\n      canAccess = Boolean(Number(fileManager.isReadableFileAtPath(path))) && Boolean(Number(fileManager.isWritableFileAtPath(path)))\n      break\n    case 7:\n      canAccess = Boolean(Number(fileManager.isReadableFileAtPath(path))) && Boolean(Number(fileManager.isWritableFileAtPath(path))) && Boolean(Number(fileManager.isExecutableFileAtPath(path)))\n      break\n  }\n\n  if (!canAccess) {\n    throw new Error('Can\\'t access ' + String(path))\n  }\n}\n\nmodule.exports.appendFileSync = function(file, data, options) {\n  if (!module.exports.existsSync(file)) {\n    return module.exports.writeFileSync(file, data, options)\n  }\n\n  var handle = NSFileHandle.fileHandleForWritingAtPath(file)\n  handle.seekToEndOfFile()\n\n  var encoding = encodingFromOptions(options, 'utf8')\n\n  var nsdata = Buffer.from(data, encoding === 'NSData' || encoding === 'buffer' ? undefined : encoding).toNSData()\n\n  handle.writeData(nsdata)\n}\n\nmodule.exports.chmodSync = function(path, mode) {\n  var err = MOPointer.alloc().init()\n  var fileManager = NSFileManager.defaultManager()\n  fileManager.setAttributes_ofItemAtPath_error({\n    NSFilePosixPermissions: mode\n  }, path, err)\n\n  if (err.value() !== null) {\n    throw new Error(err.value())\n  }\n}\n\nmodule.exports.copyFileSync = function(path, dest, flags) {\n  var err = MOPointer.alloc().init()\n  var fileManager = NSFileManager.defaultManager()\n  fileManager.copyItemAtPath_toPath_error(path, dest, err)\n\n  if (err.value() !== null) {\n    throw new Error(err.value())\n  }\n}\n\nmodule.exports.existsSync = function(path) {\n  var fileManager = NSFileManager.defaultManager()\n  return Boolean(Number(fileManager.fileExistsAtPath(path)))\n}\n\nmodule.exports.linkSync = function(existingPath, newPath) {\n  var err = MOPointer.alloc().init()\n  var fileManager = NSFileManager.defaultManager()\n  fileManager.linkItemAtPath_toPath_error(existingPath, newPath, err)\n\n  if (err.value() !== null) {\n    throw new Error(err.value())\n  }\n}\n\nmodule.exports.mkdirSync = function(path, mode) {\n  mode = mode || 0o777\n  var err = MOPointer.alloc().init()\n  var fileManager = NSFileManager.defaultManager()\n  fileManager.createDirectoryAtPath_withIntermediateDirectories_attributes_error(path, false, {\n    NSFilePosixPermissions: mode\n  }, err)\n\n  if (err.value() !== null) {\n    throw new Error(err.value())\n  }\n}\n\nmodule.exports.mkdtempSync = function(path) {\n  function makeid() {\n    var text = \"\";\n    var possible = \"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789\";\n\n    for (var i = 0; i < 6; i++)\n      text += possible.charAt(Math.floor(Math.random() * possible.length));\n\n    return text;\n  }\n  var tempPath = path + makeid()\n  module.exports.mkdirSync(tempPath)\n  return tempPath\n}\n\nmodule.exports.readdirSync = function(path) {\n  var fileManager = NSFileManager.defaultManager()\n  var paths = fileManager.subpathsAtPath(path)\n  var arr = []\n  for (var i = 0; i < paths.length; i++) {\n    arr.push(String(paths[i]))\n  }\n  return arr\n}\n\nmodule.exports.readFileSync = function(path, options) {\n  var encoding = encodingFromOptions(options, 'buffer')\n  var fileManager = NSFileManager.defaultManager()\n  var data = fileManager.contentsAtPath(path)\n  var buffer = Buffer.from(data)\n\n  if (encoding === 'buffer') {\n    return buffer\n  } else if (encoding === 'NSData') {\n    return buffer.toNSData()\n  } else {\n    return buffer.toString(encoding)\n  }\n}\n\nmodule.exports.readlinkSync = function(path) {\n  var err = MOPointer.alloc().init()\n  var fileManager = NSFileManager.defaultManager()\n  var result = fileManager.destinationOfSymbolicLinkAtPath_error(path, err)\n\n  if (err.value() !== null) {\n    throw new Error(err.value())\n  }\n\n  return String(result)\n}\n\nmodule.exports.realpathSync = function(path) {\n  return String(NSString.stringByResolvingSymlinksInPath(path))\n}\n\nmodule.exports.renameSync = function(oldPath, newPath) {\n  var err = MOPointer.alloc().init()\n  var fileManager = NSFileManager.defaultManager()\n  fileManager.moveItemAtPath_toPath_error(oldPath, newPath, err)\n\n  if (err.value() !== null) {\n    throw new Error(err.value())\n  }\n}\n\nmodule.exports.rmdirSync = function(path) {\n  var err = MOPointer.alloc().init()\n  var fileManager = NSFileManager.defaultManager()\n  fileManager.removeItemAtPath_error(path, err)\n\n  if (err.value() !== null) {\n    throw new Error(err.value())\n  }\n}\n\nmodule.exports.statSync = function(path) {\n  var err = MOPointer.alloc().init()\n  var fileManager = NSFileManager.defaultManager()\n  var result = fileManager.attributesOfItemAtPath_error(path, err)\n\n  if (err.value() !== null) {\n    throw new Error(err.value())\n  }\n\n  return {\n    dev: String(result.NSFileDeviceIdentifier),\n    // ino: 48064969, The file system specific \"Inode\" number for the file.\n    mode: result.NSFileType | result.NSFilePosixPermissions,\n    nlink: Number(result.NSFileReferenceCount),\n    uid: String(result.NSFileOwnerAccountID),\n    gid: String(result.NSFileGroupOwnerAccountID),\n    // rdev: 0, A numeric device identifier if the file is considered \"special\".\n    size: Number(result.NSFileSize),\n    // blksize: 4096, The file system block size for i/o operations.\n    // blocks: 8, The number of blocks allocated for this file.\n    atimeMs: Number(result.NSFileModificationDate.timeIntervalSince1970()) * 1000,\n    mtimeMs: Number(result.NSFileModificationDate.timeIntervalSince1970()) * 1000,\n    ctimeMs: Number(result.NSFileModificationDate.timeIntervalSince1970()) * 1000,\n    birthtimeMs: Number(result.NSFileCreationDate.timeIntervalSince1970()) * 1000,\n    atime: new Date(Number(result.NSFileModificationDate.timeIntervalSince1970()) * 1000 + 0.5), // the 0.5 comes from the node source. Not sure why it's added but in doubt...\n    mtime: new Date(Number(result.NSFileModificationDate.timeIntervalSince1970()) * 1000 + 0.5),\n    ctime: new Date(Number(result.NSFileModificationDate.timeIntervalSince1970()) * 1000 + 0.5),\n    birthtime: new Date(Number(result.NSFileCreationDate.timeIntervalSince1970()) * 1000 + 0.5),\n    isBlockDevice: function() { return result.NSFileType === NSFileTypeBlockSpecial },\n    isCharacterDevice: function() { return result.NSFileType === NSFileTypeCharacterSpecial },\n    isDirectory: function() { return result.NSFileType === NSFileTypeDirectory },\n    isFIFO: function() { return false },\n    isFile: function() { return result.NSFileType === NSFileTypeRegular },\n    isSocket: function() { return result.NSFileType === NSFileTypeSocket },\n    isSymbolicLink: function() { return result.NSFileType === NSFileTypeSymbolicLink },\n  }\n}\n\nmodule.exports.symlinkSync = function(target, path) {\n  var err = MOPointer.alloc().init()\n  var fileManager = NSFileManager.defaultManager()\n  var result = fileManager.createSymbolicLinkAtPath_withDestinationPath_error(path, target, err)\n\n  if (err.value() !== null) {\n    throw new Error(err.value())\n  }\n}\n\nmodule.exports.truncateSync = function(path, len) {\n  var hFile = NSFileHandle.fileHandleForUpdatingAtPath(sFilePath)\n  hFile.truncateFileAtOffset(len || 0)\n  hFile.closeFile()\n}\n\nmodule.exports.unlinkSync = function(path) {\n  var err = MOPointer.alloc().init()\n  var fileManager = NSFileManager.defaultManager()\n  var result = fileManager.removeItemAtPath_error(path, err)\n\n  if (err.value() !== null) {\n    throw new Error(err.value())\n  }\n}\n\nmodule.exports.utimesSync = function(path, aTime, mTime) {\n  var err = MOPointer.alloc().init()\n  var fileManager = NSFileManager.defaultManager()\n  var result = fileManager.setAttributes_ofItemAtPath_error({\n    NSFileModificationDate: aTime\n  }, path, err)\n\n  if (err.value() !== null) {\n    throw new Error(err.value())\n  }\n}\n\nmodule.exports.writeFileSync = function(path, data, options) {\n  var encoding = encodingFromOptions(options, 'utf8')\n\n  var nsdata = Buffer.from(\n    data, encoding === 'NSData' || encoding === 'buffer' ? undefined : encoding\n  ).toNSData()\n\n  nsdata.writeToFile_atomically(path, true)\n}\n","import sketch from 'sketch'\n// documentation: https://developer.sketchapp.com/reference/api/\nconst fs = require('@skpm/fs')\nconst util = require('./util')\nconst { toArray } = require('util')\nvar Dom = require('sketch/dom')\n// pixi识别的所有类型的元素\nconst types = [\n  MSTextLayer, MSRectangleShape, MSBitmapLayer, MSLayerGroup, MSHotspotLayer\n]\n\nvar Document = Dom.Document\nvar json = {\n  screen: {\n    width: 1920,\n    height: 1080\n  },\n  background: '',\n  backgroundColor: '0xFFFFFF',\n  bgScale: 1.25,\n  res: [],\n  eases: {\n    moveIn: \"easeOutCubic\",\n    moveOut: \"easeInCubic\",\n    zoomIn: \"easeInCubic\",\n    zoomOut: \"easeOutCubic\"\n  },\n  fonts: [\n    {\n      \"name\": \"Didot-Bold\",\n      \"src\": \"http://yun.media.bztone.com/prezi/asensio/font/Didot-Bold.ttf\"\n    },\n    {\n      \"name\": \"OpenSans\",\n      \"src\": \"http://yun.media.bztone.com/prezi/asensio/font/OpenSans.ttf\"\n    },\n    {\n      \"name\": \"SourceHanSansCN\",\n      \"src\": \"http://yun.media.bztone.com/prezi/asensio/font/asensio.ttf\"\n    }\n  ],\n  main: {\n    x: 1920,\n    y: 1080,\n    scale: 1,\n    son: [],\n    content: []\n  }\n}\nvar artboards = []\nvar document = Document.getSelectedDocument()\nvar globalContent = null\n\nexport default function (content) {\n  globalContent = content\n  const doc = globalContent.document;\n  const pages = doc.pages()\n\n  pages.forEach((page, index) => {\n    console.log('pageIndex : ' + (index + 1) + ', pageName : ' + page.name())\n    // page.layers().forEach(layer => {\n    //   artboards.unshift(layer)\n    // })\n    artboards = page.layers()\n    createLevel(artboards[0], json.main)\n    // 把输出结果写入json文件\n    fs.writeFileSync(getScriptFolder(globalContent) + '/test.json', JSON.stringify(json))\n  })\n}\n\nfunction getScriptFolder(content) {\n  const parts = content.scriptPath.split('/')\n  parts.pop()\n  return parts.join('/')\n}\n\n// 判断artboard是否有下一级\nfunction createLevel(artboard, current) {\n  console.log('artboard id : ' + artboard.objectID())\n  let scale = current.scale\n  let layers = artboard.layers()\n  layers.forEach(layer => {\n    console.log(layer)\n    let type = layer.class()\n    let id = layer.objectID()\n    let tempLayer = document.getLayerWithID(id)\n    let name = tempLayer.name\n    let format = getImageFormat(layer)\n    if (name === 'BG') {\n      json.background = 'http://pixi.bztone.com/' + name + '.' + (format ? format : 'JPG')\n    } else if (types.indexOf(type) != -1 && !tempLayer.hidden) {\n      console.log('tempLayer')\n      console.log(tempLayer)\n      if (tempLayer.flow && tempLayer.flow.targetId) {\n        if (type === MSHotspotLayer) {\n          // 当前元素是热点区,指向下一级页面(artboard),\n          // 找是否存在指向同一个artboard的元素,如果存在,那是子级页面的入口\n          let targetId = tempLayer.flow.targetId\n          let artboardLayer = getArtboard(targetId)\n          let sonLayer = getSonByHotspot(layers, targetId)\n          let son = {\n            x: layer.frame().left(),\n            y: layer.frame().top(),\n            scale: artboardLayer.frame().width() / layer.frame().width(),\n            son: [],\n            content: []\n          }\n          if (sonLayer) {\n            let sonContent = {\n              x: (sonLayer.frame().left() - son.x) * son.scale,\n              y: (sonLayer.frame().top() - son.y) * son.scale,\n              width: sonLayer.frame().width() * son.scale,\n              height: sonLayer.frame().height() * son.scale,\n              data: {\n                type: getTypeByLayerType(sonLayer.class()),\n                look: 'son'\n              }\n            }\n            let sonTempLayer = document.getLayerWithID(sonLayer.objectID())\n            sonContent = createElement(sonLayer, sonTempLayer, sonContent, 1 / scale)\n            son.content.push(sonContent)\n          }\n\n          createLevel(artboardLayer, son)\n          current.son.push(son)\n        }\n      } else {\n        let style = tempLayer.style\n        console.log('type : ' + type)\n        console.log('rotation : ' + layer.rotation())\n        let frame = layer.frame()\n        let content = {\n          x: frame.left(),\n          y: frame.top(),\n          width: frame.width(),\n          height: frame.height(),\n          data: {\n            alpha: style.opacity,\n            look: 'in',\n            overSon: isOverSon(tempLayer.name)\n          }\n        }\n        if (layer.rotation()) {\n          content.data.angle = layer.rotation()\n        }\n\n        content = createElement(layer, tempLayer, content, 1)\n        current.content.push(content)\n      }\n    }\n  })\n}\n\n// 查询artboard\nfunction getArtboard(targetId) {\n  const doc = globalContent.document;\n  const pages = doc.pages()\n  let data = null\n  for (let i = 0; i < pages.length; i++) {\n    let page = pages[i]\n    let layers = page.layers()\n    for (let j = 0; j < layers.length; j++) {\n      let artboard = layers[j]\n      if (artboard.objectID() == targetId) {\n        data = artboard\n        break\n      }\n    }\n  }\n  return data\n}\n\n// 在当前artboard里面找到与热点指向的下一级页面一样的元素\nfunction getSonByHotspot(layers, targetId) {\n  let sonLayer = null\n  for (let i = 0; i < layers.length; i++) {\n    let layer = layers[i]\n    let id = layer.objectID()\n    let tempLayer = document.getLayerWithID(id)\n    let type = layer.class()\n    if (type != MSHotspotLayer &&\n      tempLayer.flow && tempLayer.flow.targetId\n      && tempLayer.flow.targetId == targetId) {\n      sonLayer = layer\n      break\n    }\n  }\n  return sonLayer\n}\n\n// layer的type => pixi的type\nfunction getTypeByLayerType(layerType) {\n  let type = 'rect'\n  switch (layerType) {\n    case MSTextLayer:\n      type = 'text'\n      break\n    case MSBitmapLayer:\n      type = 'image'\n      break\n    default:\n      break\n  }\n  return type\n}\n\n// layer => content\nfunction createElement(layer, tempLayer, content, scale) {\n  let style = tempLayer.style\n  let fill = null\n  if (style.fills.length > 0) {\n    fill = style.fills[0]\n  }\n  let border = null\n  if (style.borders.length > 0) {\n    border = style.borders[0]\n  }\n\n  let type = layer.class()\n  if (type === MSTextLayer) {\n    // 字体\n    let textColor = layer.textColor()\n    content.data = Object.assign(content.data, {\n      type: getTypeByLayerType(type),\n      text: layer.stringValue() + '',\n      fontFamily: layer.font().fontName() + '',\n      fontSize: layer.fontSize() / scale,\n      fill: util.rgb2hex(textColor.red(), textColor.green(), textColor.blue(), textColor.alpha()),\n      lineHeight: layer.lineHeight(),\n      leading: layer.leading(),\n      align: layer.textAlignment() === 1 ? 'right' : (layer.textAlignment() === 2 ? 'center' : 'left'),\n      wordWrap: true,\n      breakWords: false,\n      wordWrapWith: null\n    })\n  }\n  if (type === MSRectangleShape) {\n    // 方框\n    content.data = Object.assign(content.data, {\n      type: getTypeByLayerType(type),\n      radius: layer.cornerRadiusFloat() / scale\n    })\n    // 填充色\n    content.data = Object.assign(content.data, {\n      fill: fill ? util.getColor(fill.color) : '0xFFFFFF',\n      opacity: fill ? util.getAlphaFromHex(fill.color) : 1\n    })\n    // 边框\n    if (border) {\n      content.data = Object.assign(content.data, {\n        lineWidth: border.thickness / scale,\n        lineColor: util.getColor(border.color),\n        lineOpacity: util.getAlphaFromHex(border.color),\n        lineAlign: border.position === 'Inside' ? 1 : (border.position === 'Center' ? 0.5 : 0)\n      })\n    }\n  }\n  if (type === MSBitmapLayer) {\n    // 照片\n    // 同一张图片可以根据ID判断tempLayer.image.id\n    // let base64 = tempLayer.image.nsdata.base64EncodedStringWithOptions(0)\n    console.log('name : ' + tempLayer.name)\n\n    let format = getImageFormat(layer)\n    content.data = Object.assign(content.data, {\n      type: getTypeByLayerType(type),\n      src: 'http://pixi.bztone.com/' + getName(tempLayer.name) + '.' + (format ? format : 'JPG')\n    })\n    // tempLayer.image.nsdata.writeToFile_atomically(getScriptFolder(globalContent) + '/' + tempLayer.name + '.JPG', true)\n\n  }\n\n  if (type === MSLayerGroup) {\n    let format = getImageFormat(layer)\n    if (format) {\n      // 此group存在presets\n      content.data = Object.assign(content.data, {\n        type: getTypeByLayerType(MSBitmapLayer),\n        src: 'http://pixi.bztone.com/' + tempLayer.name + '.' + (format ? format : 'JPG')\n      })\n    }\n  }\n\n  return content\n}\n\n// get image format : png/jpg...\nfunction getImageFormat(layer) {\n  let format = null\n  let exportFormats = layer.exportOptions().exportFormats()\n  if (exportFormats && exportFormats.length > 0) {\n    format = exportFormats[0].fileFormat()\n  }\n  return format\n}\n\n// 元素名称是否含有overSon字符\nfunction isOverSon(name) {\n  return name.indexOf('_overSon') != -1\n}\n\n// 去除名称上的标记\nfunction getName(name) {\n  return name.replace('_overSon', '')\n}","\n// 获取hex里面的alpha\nexports.getAlphaFromHex = (hex) => {\n\thex = hex.replace(/^#/, '');\n\tlet alpha = 1;\n\n\tif (hex.length === 8) {\n\t\talpha = parseInt(hex.slice(6, 8), 16) / 255;\n\t}\n\n\treturn alpha\n}\n\n// 去除alpha\nexports.getColor = (hex) => {\n\tlet color = ''\n\thex = hex.replace(/^#/, '')\n\tif (hex.length === 8) {\n\t\tcolor = hex.slice(0, 6)\n\t}\n\n\treturn '0x' + color\n}\n\n// rgb to hex\nexports.rgb2hex = (red, green, blue, alpha) => {\n\tred = parseInt(red * 255)\n\tgreen = parseInt(green * 255)\n\tblue = parseInt(blue * 255)\n\tconst isPercent = (red + (alpha || '')).toString().includes('%');\n\n\tif (typeof alpha === 'number') {\n\t\tif (!isPercent && alpha >= 0 && alpha <= 1) {\n\t\t\talpha = Math.round(255 * alpha);\n\t\t} else if (isPercent && alpha >= 0 && alpha <= 100) {\n\t\t\talpha = Math.round(255 * alpha / 100);\n\t\t} else {\n\t\t\tthrow new TypeError(`Expected alpha value (${alpha}) as a fraction or percentage`);\n\t\t}\n\t\talpha = (alpha | 1 << 8).toString(16).slice(1);\n\t} else {\n\t\talpha = '';\n\t}\n\n\tlet rgb = ((blue | green << 8 | red << 16) | 1 << 24).toString(16).slice(1) + alpha\n\treturn '0x' + rgb\n}","module.exports = require(\"buffer\");","module.exports = require(\"sketch\");","module.exports = require(\"sketch/dom\");","module.exports = require(\"util\");"],"sourceRoot":""}