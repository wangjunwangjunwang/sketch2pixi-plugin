{"version":3,"sources":["webpack://exports/webpack/bootstrap","webpack://exports/./node_modules/@skpm/fs/index.js","webpack://exports/./src/switchAll.js","webpack://exports/./src/util.js","webpack://exports/external \"buffer\"","webpack://exports/external \"sketch/ui\""],"names":["fs","require","util","UI","types","MSTextLayer","MSRectangleShape","MSBitmapLayer","MSLayerGroup","MSHotspotLayer","json","screen","width","height","background","backgroundColor","bgScale","res","eases","moveIn","moveOut","zoomIn","zoomOut","fonts","main","x","y","scale","son","content","artboards","globalContent","allLayers","allArtboards","doc","document","pages","logDir","getHomeFolder","existsSync","mkdirSync","length","message","page","pageName","name","layers","forEach","artboard","push","layer","log","createLevel","jsonsDir","pixiFile","writeFileSync","JSON","stringify","parts","scriptPath","split","pop","shift","home","homeDir","join","current","type","class","format","getImageFormat","indexOf","isVisible","flow","destinationArtboardID","targetId","artboardLayer","getArtboard","sonLayer","getSonByHotspot","frame","left","top","sonContent","data","getTypeByLayerType","look","createElement","overSon","isOverSon","rotation","angle","i","objectID","layerType","style","fill","fills","border","borders","textColor","Object","assign","text","stringValue","fontFamily","font","fontName","fontSize","rgb2hex","red","green","blue","alpha","lineHeight","leading","align","textAlignment","wordWrap","breakWords","wordWrapWith","radius","cornerRadiusFloat","color","opacity","lineWidth","thickness","lineColor","lineOpacity","lineAlign","position","src","getName","exportFormats","exportOptions","fileFormat","replace","exports","getAlphaFromHex","hex","parseInt","slice","getColor","isPercent","toString","includes","Math","round","TypeError","rgb","string","dateFormatter","NSDateFormatter","alloc","init","setDateFormat","console","now","NSDate","logFile","stringFromDate","timestamp","appendFileSync"],"mappings":";;;;;;AAAA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;;AAGA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA,kDAA0C,gCAAgC;AAC1E;AACA;;AAEA;AACA;AACA;AACA,gEAAwD,kBAAkB;AAC1E;AACA,yDAAiD,cAAc;AAC/D;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iDAAyC,iCAAiC;AAC1E,wHAAgH,mBAAmB,EAAE;AACrI;AACA;;AAEA;AACA;AACA;AACA,mCAA2B,0BAA0B,EAAE;AACvD,yCAAiC,eAAe;AAChD;AACA;AACA;;AAEA;AACA,8DAAsD,+DAA+D;;AAErH;AACA;;;AAGA;AACA;;;;;;;;;;;;AClFA;AACA;AACA,aAAa,mBAAO,CAAC,sBAAQ;;AAE7B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,GAAG;;AAEH;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;;AAEH;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA,mBAAmB,OAAO;AAC1B;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,iBAAiB,kBAAkB;AACnC;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,GAAG;AACH;AACA,GAAG;AACH;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,+BAA+B,sDAAsD;AACrF,mCAAmC,0DAA0D;AAC7F,6BAA6B,mDAAmD;AAChF,wBAAwB,eAAe;AACvC,wBAAwB,iDAAiD;AACzE,0BAA0B,gDAAgD;AAC1E,gCAAgC,sDAAsD;AACtF;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,GAAG;;AAEH;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;;;;;;;;;;;;AC1RA;AAAA;AACA;AACA,IAAMA,EAAE,GAAGC,mBAAO,CAAC,kDAAD,CAAlB;;AACA,IAAMC,IAAI,GAAGD,mBAAO,CAAC,6BAAD,CAApB;;AACA,IAAME,EAAE,GAAGF,mBAAO,CAAC,4BAAD,CAAlB,C,CACA;;;AACA,IAAMG,KAAK,GAAG,CACZC,WADY,EACCC,gBADD,EACmBC,aADnB,EACkCC,YADlC,EACgDC,cADhD,CAAd,C,CAIA;;AACA,IAAIC,IAAI,GAAG;AACTC,QAAM,EAAE;AACNC,SAAK,EAAE,IADD;AAENC,UAAM,EAAE;AAFF,GADC;AAKTC,YAAU,EAAE,EALH;AAMTC,iBAAe,EAAE,UANR;AAOTC,SAAO,EAAE,IAPA;AAQTC,KAAG,EAAE,EARI;AASTC,OAAK,EAAE;AACLC,UAAM,EAAE,cADH;AAELC,WAAO,EAAE,aAF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","file":"switchAll.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = \"./src/switchAll.js\");\n","// TODO: async. Should probably be done with NSFileHandle and some notifications\n// TODO: file descriptor. Needs to be done with NSFileHandle\nvar Buffer = require('buffer').Buffer\n\nfunction encodingFromOptions(options, defaultValue) {\n  return options && options.encoding\n    ? String(options.encoding)\n    : (\n      options\n        ? String(options)\n        : defaultValue\n    )\n}\n\nmodule.exports.constants = {\n  F_OK: 0,\n  R_OK: 4,\n  W_OK: 2,\n  X_OK: 1\n}\n\nmodule.exports.accessSync = function(path, mode) {\n  mode = mode | 0\n  var fileManager = NSFileManager.defaultManager()\n\n  switch (mode) {\n    case 0:\n      canAccess = module.exports.existsSync(path)\n      break\n    case 1:\n      canAccess = Boolean(Number(fileManager.isExecutableFileAtPath(path)))\n      break\n    case 2:\n      canAccess = Boolean(Number(fileManager.isWritableFileAtPath(path)))\n      break\n    case 3:\n      canAccess = Boolean(Number(fileManager.isExecutableFileAtPath(path))) && Boolean(Number(fileManager.isWritableFileAtPath(path)))\n      break\n    case 4:\n      canAccess = Boolean(Number(fileManager.isReadableFileAtPath(path)))\n      break\n    case 5:\n      canAccess = Boolean(Number(fileManager.isReadableFileAtPath(path))) && Boolean(Number(fileManager.isExecutableFileAtPath(path)))\n      break\n    case 6:\n      canAccess = Boolean(Number(fileManager.isReadableFileAtPath(path))) && Boolean(Number(fileManager.isWritableFileAtPath(path)))\n      break\n    case 7:\n      canAccess = Boolean(Number(fileManager.isReadableFileAtPath(path))) && Boolean(Number(fileManager.isWritableFileAtPath(path))) && Boolean(Number(fileManager.isExecutableFileAtPath(path)))\n      break\n  }\n\n  if (!canAccess) {\n    throw new Error('Can\\'t access ' + String(path))\n  }\n}\n\nmodule.exports.appendFileSync = function(file, data, options) {\n  if (!module.exports.existsSync(file)) {\n    return module.exports.writeFileSync(file, data, options)\n  }\n\n  var handle = NSFileHandle.fileHandleForWritingAtPath(file)\n  handle.seekToEndOfFile()\n\n  var encoding = encodingFromOptions(options, 'utf8')\n\n  var nsdata = Buffer.from(data, encoding === 'NSData' || encoding === 'buffer' ? undefined : encoding).toNSData()\n\n  handle.writeData(nsdata)\n}\n\nmodule.exports.chmodSync = function(path, mode) {\n  var err = MOPointer.alloc().init()\n  var fileManager = NSFileManager.defaultManager()\n  fileManager.setAttributes_ofItemAtPath_error({\n    NSFilePosixPermissions: mode\n  }, path, err)\n\n  if (err.value() !== null) {\n    throw new Error(err.value())\n  }\n}\n\nmodule.exports.copyFileSync = function(path, dest, flags) {\n  var err = MOPointer.alloc().init()\n  var fileManager = NSFileManager.defaultManager()\n  fileManager.copyItemAtPath_toPath_error(path, dest, err)\n\n  if (err.value() !== null) {\n    throw new Error(err.value())\n  }\n}\n\nmodule.exports.existsSync = function(path) {\n  var fileManager = NSFileManager.defaultManager()\n  return Boolean(Number(fileManager.fileExistsAtPath(path)))\n}\n\nmodule.exports.linkSync = function(existingPath, newPath) {\n  var err = MOPointer.alloc().init()\n  var fileManager = NSFileManager.defaultManager()\n  fileManager.linkItemAtPath_toPath_error(existingPath, newPath, err)\n\n  if (err.value() !== null) {\n    throw new Error(err.value())\n  }\n}\n\nmodule.exports.mkdirSync = function(path, mode) {\n  mode = mode || 0o777\n  var err = MOPointer.alloc().init()\n  var fileManager = NSFileManager.defaultManager()\n  fileManager.createDirectoryAtPath_withIntermediateDirectories_attributes_error(path, false, {\n    NSFilePosixPermissions: mode\n  }, err)\n\n  if (err.value() !== null) {\n    throw new Error(err.value())\n  }\n}\n\nmodule.exports.mkdtempSync = function(path) {\n  function makeid() {\n    var text = \"\";\n    var possible = \"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789\";\n\n    for (var i = 0; i < 6; i++)\n      text += possible.charAt(Math.floor(Math.random() * possible.length));\n\n    return text;\n  }\n  var tempPath = path + makeid()\n  module.exports.mkdirSync(tempPath)\n  return tempPath\n}\n\nmodule.exports.readdirSync = function(path) {\n  var fileManager = NSFileManager.defaultManager()\n  var paths = fileManager.subpathsAtPath(path)\n  var arr = []\n  for (var i = 0; i < paths.length; i++) {\n    arr.push(String(paths[i]))\n  }\n  return arr\n}\n\nmodule.exports.readFileSync = function(path, options) {\n  var encoding = encodingFromOptions(options, 'buffer')\n  var fileManager = NSFileManager.defaultManager()\n  var data = fileManager.contentsAtPath(path)\n  var buffer = Buffer.from(data)\n\n  if (encoding === 'buffer') {\n    return buffer\n  } else if (encoding === 'NSData') {\n    return buffer.toNSData()\n  } else {\n    return buffer.toString(encoding)\n  }\n}\n\nmodule.exports.readlinkSync = function(path) {\n  var err = MOPointer.alloc().init()\n  var fileManager = NSFileManager.defaultManager()\n  var result = fileManager.destinationOfSymbolicLinkAtPath_error(path, err)\n\n  if (err.value() !== null) {\n    throw new Error(err.value())\n  }\n\n  return String(result)\n}\n\nmodule.exports.realpathSync = function(path) {\n  return String(NSString.stringByResolvingSymlinksInPath(path))\n}\n\nmodule.exports.renameSync = function(oldPath, newPath) {\n  var err = MOPointer.alloc().init()\n  var fileManager = NSFileManager.defaultManager()\n  fileManager.moveItemAtPath_toPath_error(oldPath, newPath, err)\n\n  if (err.value() !== null) {\n    throw new Error(err.value())\n  }\n}\n\nmodule.exports.rmdirSync = function(path) {\n  var err = MOPointer.alloc().init()\n  var fileManager = NSFileManager.defaultManager()\n  fileManager.removeItemAtPath_error(path, err)\n\n  if (err.value() !== null) {\n    throw new Error(err.value())\n  }\n}\n\nmodule.exports.statSync = function(path) {\n  var err = MOPointer.alloc().init()\n  var fileManager = NSFileManager.defaultManager()\n  var result = fileManager.attributesOfItemAtPath_error(path, err)\n\n  if (err.value() !== null) {\n    throw new Error(err.value())\n  }\n\n  return {\n    dev: String(result.NSFileDeviceIdentifier),\n    // ino: 48064969, The file system specific \"Inode\" number for the file.\n    mode: result.NSFileType | result.NSFilePosixPermissions,\n    nlink: Number(result.NSFileReferenceCount),\n    uid: String(result.NSFileOwnerAccountID),\n    gid: String(result.NSFileGroupOwnerAccountID),\n    // rdev: 0, A numeric device identifier if the file is considered \"special\".\n    size: Number(result.NSFileSize),\n    // blksize: 4096, The file system block size for i/o operations.\n    // blocks: 8, The number of blocks allocated for this file.\n    atimeMs: Number(result.NSFileModificationDate.timeIntervalSince1970()) * 1000,\n    mtimeMs: Number(result.NSFileModificationDate.timeIntervalSince1970()) * 1000,\n    ctimeMs: Number(result.NSFileModificationDate.timeIntervalSince1970()) * 1000,\n    birthtimeMs: Number(result.NSFileCreationDate.timeIntervalSince1970()) * 1000,\n    atime: new Date(Number(result.NSFileModificationDate.timeIntervalSince1970()) * 1000 + 0.5), // the 0.5 comes from the node source. Not sure why it's added but in doubt...\n    mtime: new Date(Number(result.NSFileModificationDate.timeIntervalSince1970()) * 1000 + 0.5),\n    ctime: new Date(Number(result.NSFileModificationDate.timeIntervalSince1970()) * 1000 + 0.5),\n    birthtime: new Date(Number(result.NSFileCreationDate.timeIntervalSince1970()) * 1000 + 0.5),\n    isBlockDevice: function() { return result.NSFileType === NSFileTypeBlockSpecial },\n    isCharacterDevice: function() { return result.NSFileType === NSFileTypeCharacterSpecial },\n    isDirectory: function() { return result.NSFileType === NSFileTypeDirectory },\n    isFIFO: function() { return false },\n    isFile: function() { return result.NSFileType === NSFileTypeRegular },\n    isSocket: function() { return result.NSFileType === NSFileTypeSocket },\n    isSymbolicLink: function() { return result.NSFileType === NSFileTypeSymbolicLink },\n  }\n}\n\nmodule.exports.symlinkSync = function(target, path) {\n  var err = MOPointer.alloc().init()\n  var fileManager = NSFileManager.defaultManager()\n  var result = fileManager.createSymbolicLinkAtPath_withDestinationPath_error(path, target, err)\n\n  if (err.value() !== null) {\n    throw new Error(err.value())\n  }\n}\n\nmodule.exports.truncateSync = function(path, len) {\n  var hFile = NSFileHandle.fileHandleForUpdatingAtPath(sFilePath)\n  hFile.truncateFileAtOffset(len || 0)\n  hFile.closeFile()\n}\n\nmodule.exports.unlinkSync = function(path) {\n  var err = MOPointer.alloc().init()\n  var fileManager = NSFileManager.defaultManager()\n  var result = fileManager.removeItemAtPath_error(path, err)\n\n  if (err.value() !== null) {\n    throw new Error(err.value())\n  }\n}\n\nmodule.exports.utimesSync = function(path, aTime, mTime) {\n  var err = MOPointer.alloc().init()\n  var fileManager = NSFileManager.defaultManager()\n  var result = fileManager.setAttributes_ofItemAtPath_error({\n    NSFileModificationDate: aTime\n  }, path, err)\n\n  if (err.value() !== null) {\n    throw new Error(err.value())\n  }\n}\n\nmodule.exports.writeFileSync = function(path, data, options) {\n  var encoding = encodingFromOptions(options, 'utf8')\n\n  var nsdata = Buffer.from(\n    data, encoding === 'NSData' || encoding === 'buffer' ? undefined : encoding\n  ).toNSData()\n\n  nsdata.writeToFile_atomically(path, true)\n}\n","// import sketch from 'sketch'\n// documentation: https://developer.sketchapp.com/reference/api/\nconst fs = require('@skpm/fs')\nconst util = require('./util')\nconst UI = require('sketch/ui')\n// pixi识别的所有类型的元素\nconst types = [\n  MSTextLayer, MSRectangleShape, MSBitmapLayer, MSLayerGroup, MSHotspotLayer\n]\n\n// var Document = Dom.Document\nvar json = {\n  screen: {\n    width: 1920,\n    height: 1080\n  },\n  background: '',\n  backgroundColor: '0xFFFFFF',\n  bgScale: 1.25,\n  res: [],\n  eases: {\n    moveIn: \"easeOutCubic\",\n    moveOut: \"easeInCubic\",\n    zoomIn: \"easeInCubic\",\n    zoomOut: \"easeOutCubic\"\n  },\n  fonts: [\n    {\n      \"name\": \"Didot-Bold\",\n      \"src\": \"http://yun.media.bztone.com/prezi/asensio/font/Didot-Bold.ttf\"\n    },\n    {\n      \"name\": \"OpenSans\",\n      \"src\": \"http://yun.media.bztone.com/prezi/asensio/font/OpenSans.ttf\"\n    },\n    {\n      \"name\": \"SourceHanSansCN\",\n      \"src\": \"http://yun.media.bztone.com/prezi/asensio/font/asensio.ttf\"\n    }\n  ],\n  main: {\n    x: 1920,\n    y: 1080,\n    scale: 1,\n    son: [],\n    content: []\n  }\n}\nvar artboards = []\n// var document = Document.getSelectedDocument()\nvar globalContent = null\nvar allLayers = []\nvar allArtboards = []\n\nexport default function (content) {\n  globalContent = content\n  const doc = globalContent.document;\n  const pages = doc.pages()\n\n  // log dir\n  let logDir = getHomeFolder(globalContent) + 'logs/'\n  fs.existsSync(logDir) || fs.mkdirSync(logDir)\n\n  if (pages.length === 0) {\n    UI.message('请选择一个page!')\n    return\n  }\n\n  const page = pages[0]\n  const pageName = page.name()\n\n  let artboards = page.layers()\n  artboards.forEach(artboard => {\n    allArtboards.push(artboard)\n    let layers = artboard.layers()\n    layers.forEach(layer => allLayers.push(layer))\n  })\n\n  util.log(logDir,`allLayers length : ${allLayers.length}`)\n  util.log(logDir,`allArtboards length :  ${allArtboards.length}`)\n\n  artboards = page.layers()\n  createLevel(artboards[0], json.main)\n  // 把输出结果写入json文件\n  let jsonsDir = getHomeFolder(globalContent) + 'jsons/'\n  fs.existsSync(jsonsDir) || fs.mkdirSync(jsonsDir)\n  let pixiFile = jsonsDir + `${pageName}.json`\n  \n  util.log(logDir, `jsonFileName : ${pageName}`)\n\n  fs.writeFileSync(pixiFile, JSON.stringify(json))\n  UI.message('转换完成!')\n}\n\nfunction getHomeFolder(content) {\n  const parts = content.scriptPath.split('/')\n  parts.pop()\n  parts.shift()\n  let home = []\n  home.push(parts[0])\n  home.push(parts[1])\n  let homeDir = '/' + home.join('/') + '/sketch2pixi-plugin/'\n  fs.existsSync(homeDir) || fs.mkdirSync(homeDir) \n  return homeDir\n}\n\n// 判断artboard是否有下一级\nfunction createLevel(artboard, current) {\n  UI.message('正在转换 : ' + artboard.name())\n  let scale = current.scale\n  let layers = artboard.layers()\n  layers.forEach(layer => {\n    let type = layer.class()\n    let name = layer.name()\n    let format = getImageFormat(layer)\n    if (name == 'BG') {\n      json.background = 'http://pixi.bztone.com/' + name + '.' + (format ? format : 'JPG')\n    } else if (types.indexOf(type) != -1 && layer.isVisible() == 1) {\n      if (layer.flow() && layer.flow().destinationArtboardID()) {\n        if (type === MSHotspotLayer) {\n          // 当前元素是热点区,指向下一级页面(artboard),\n          // 找是否存在指向同一个artboard的元素,如果存在,那是子级页面的入口\n          let targetId = layer.flow().destinationArtboardID()\n          let artboardLayer = getArtboard(targetId)\n          if (artboardLayer) {\n            let sonLayer = getSonByHotspot(layers, targetId)\n            let son = {\n              x: layer.frame().left(),\n              y: layer.frame().top(),\n              scale: artboardLayer.frame().width() / layer.frame().width(),\n              son: [],\n              content: []\n            }\n            if (sonLayer) {\n              let sonContent = {\n                x: (sonLayer.frame().left() - son.x) * son.scale,\n                y: (sonLayer.frame().top() - son.y) * son.scale,\n                width: sonLayer.frame().width() * son.scale,\n                height: sonLayer.frame().height() * son.scale,\n                data: {\n                  type: getTypeByLayerType(sonLayer.class()),\n                  look: 'son'\n                }\n              }\n              sonContent = createElement(sonLayer, sonContent, 1 / scale)\n              son.content.push(sonContent)\n            }\n\n            createLevel(artboardLayer, son)\n            current.son.push(son)\n          }\n        }\n      } else {\n        let frame = layer.frame()\n        let content = {\n          x: frame.left(),\n          y: frame.top(),\n          width: frame.width(),\n          height: frame.height(),\n          data: {\n            // alpha: style.opacity(),\n            look: 'in',\n            overSon: isOverSon(layer.name())\n          }\n        }\n        if (layer.rotation()) {\n          content.data.angle = layer.rotation()\n        }\n\n        content = createElement(layer, content, 1)\n        current.content.push(content)\n      }\n    }\n  })\n}\n\n// 查询artboard\nfunction getArtboard(targetId) {\n  let data = null\n  for (let i = 0; i < allArtboards.length; i++) {\n    let artboard = allArtboards[i]\n    if ('' + artboard.objectID() == '' + targetId) {\n      data = artboard\n      break\n    }\n  }\n  return data\n}\n\n// 在当前artboard里面找到与热点指向的下一级页面一样的元素\nfunction getSonByHotspot(layers, targetId) {\n  let sonLayer = null\n  for (let i = 0; i < layers.length; i++) {\n    let layer = layers[i]\n    let type = layer.class()\n    if (type != MSHotspotLayer &&\n      layer.flow() && layer.flow().destinationArtboardID()\n      && ('' + layer.flow().destinationArtboardID()) == ('' + targetId)) {\n      sonLayer = layer\n      break\n    }\n  }\n  return sonLayer\n}\n\n// layer的type => pixi的type\nfunction getTypeByLayerType(layerType) {\n  let type = 'rect'\n  switch (layerType) {\n    case MSTextLayer:\n      type = 'text'\n      break\n    case MSBitmapLayer:\n      type = 'image'\n      break\n    default:\n      break\n  }\n  return type\n}\n\n// layer => content\nfunction createElement(layer, content, scale) {\n  let style = layer.style()\n  let fill = null\n  if (style.fills().length > 0) {\n    fill = style.fills()[0]\n  }\n  let border = null\n  if (style.borders().length > 0) {\n    border = style.borders()[0]\n  }\n\n  let type = layer.class()\n  if (type === MSTextLayer) {\n    // 字体\n    let textColor = layer.textColor()\n    content.data = Object.assign(content.data, {\n      type: getTypeByLayerType(type),\n      text: layer.stringValue() + '',\n      fontFamily: layer.font().fontName() + '',\n      fontSize: layer.fontSize() / scale,\n      fill: util.rgb2hex(textColor.red(), textColor.green(), textColor.blue(), textColor.alpha()),\n      lineHeight: layer.lineHeight(),\n      leading: layer.leading(),\n      align: layer.textAlignment() === 1 ? 'right' : (layer.textAlignment() === 2 ? 'center' : 'left'),\n      wordWrap: true,\n      breakWords: false,\n      wordWrapWith: null\n    })\n  }\n  if (type === MSRectangleShape) {\n    // 方框\n    content.data = Object.assign(content.data, {\n      type: getTypeByLayerType(type),\n      radius: layer.cornerRadiusFloat() / scale\n    })\n    // 填充色\n    content.data = Object.assign(content.data, {\n      fill: fill ? util.rgb2hex(fill.color().red(), fill.color().green(), fill.color().blue()) : '0xFFFFFF',\n      opacity: fill ? fill.color().alpha() : 1\n    })\n    // 边框\n    if (border) {\n      content.data = Object.assign(content.data, {\n        lineWidth: border.thickness() / scale,\n        lineColor: util.rgb2hex(border.color().red(), border.color().green(), border.color().blue()),\n        lineOpacity: border.color().alpha(),\n        lineAlign: border.position() === 'Inside' ? 1 : (border.position() === 'Center' ? 0.5 : 0)\n      })\n    }\n  }\n  if (type === MSBitmapLayer) {\n    // 照片\n    // 同一张图片可以根据ID判断tempLayer.image.id\n    // let base64 = tempLayer.image.nsdata.base64EncodedStringWithOptions(0)\n    let name = layer.name()\n\n    let format = getImageFormat(layer)\n    content.data = Object.assign(content.data, {\n      type: getTypeByLayerType(type),\n      src: 'http://pixi.bztone.com/' + getName(name) + '.' + (format ? format : 'JPG')\n    })\n    // tempLayer.image.nsdata.writeToFile_atomically(getScriptFolder(globalContent) + '/' + tempLayer.name + '.JPG', true)\n\n  }\n\n  if (type === MSLayerGroup) {\n    let format = getImageFormat(layer)\n    if (format) {\n      // 此group存在presets\n      content.data = Object.assign(content.data, {\n        type: getTypeByLayerType(MSBitmapLayer),\n        src: 'http://pixi.bztone.com/' + layer.name() + '.' + (format ? format : 'JPG')\n      })\n    }\n  }\n\n  return content\n}\n\n// get image format : png/jpg...\nfunction getImageFormat(layer) {\n  let format = null\n  let exportFormats = layer.exportOptions().exportFormats()\n  if (exportFormats && exportFormats.length > 0) {\n    format = exportFormats[0].fileFormat()\n  }\n  return format\n}\n\n// 元素名称是否含有overSon字符\nfunction isOverSon(name) {\n  return name.indexOf('_overSon') != -1\n}\n\n// 去除名称上的标记\nfunction getName(name) {\n  return name.replace('_overSon', '')\n}","const fs = require('@skpm/fs')\n\n// 获取hex里面的alpha\nexports.getAlphaFromHex = (hex) => {\n\thex = hex.replace(/^#/, '');\n\tlet alpha = 1;\n\n\tif (hex.length === 8) {\n\t\talpha = parseInt(hex.slice(6, 8), 16) / 255;\n\t}\n\n\treturn alpha\n}\n\n// 去除alpha\nexports.getColor = (hex) => {\n\tlet color = ''\n\thex = hex.replace(/^#/, '')\n\tif (hex.length === 8) {\n\t\tcolor = hex.slice(0, 6)\n\t}\n\n\treturn '0x' + color\n}\n\n// rgb to hex\nexports.rgb2hex = (red, green, blue, alpha) => {\n\tred = parseInt(red * 255)\n\tgreen = parseInt(green * 255)\n\tblue = parseInt(blue * 255)\n\tconst isPercent = (red + (alpha || '')).toString().includes('%');\n\n\tif (typeof alpha === 'number') {\n\t\tif (!isPercent && alpha >= 0 && alpha <= 1) {\n\t\t\talpha = Math.round(255 * alpha);\n\t\t} else if (isPercent && alpha >= 0 && alpha <= 100) {\n\t\t\talpha = Math.round(255 * alpha / 100);\n\t\t} else {\n\t\t\tthrow new TypeError(`Expected alpha value (${alpha}) as a fraction or percentage`);\n\t\t}\n\t\talpha = (alpha | 1 << 8).toString(16).slice(1);\n\t} else {\n\t\talpha = '';\n\t}\n\n\tlet rgb = ((blue | green << 8 | red << 16) | 1 << 24).toString(16).slice(1) + alpha\n\treturn '0x' + rgb\n}\n\n// append log to path\nexports.log = (logDir, string) => {\n\tlet dateFormatter = NSDateFormatter.alloc().init()\n  dateFormatter.setDateFormat('YYYY-MM-dd')\n\tconsole.log(dateFormatter)\n\tlet now = NSDate.alloc().init()\n\tlet logFile = logDir + dateFormatter.stringFromDate(now) + '.log'\n\tdateFormatter.setDateFormat('YYYY-MM-dd hh:mm:ss')\n\tlet timestamp = dateFormatter.stringFromDate(now) + ' --- '\n\tif (!fs.existsSync(logFile)) fs.writeFileSync(logFile, timestamp + string + '\\n')\n\telse fs.appendFileSync(logFile, timestamp + string + '\\n')\n}","module.exports = require(\"buffer\");","module.exports = require(\"sketch/ui\");"],"sourceRoot":""}